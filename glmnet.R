classification<-read.csv(file='C:/Users/USUARIO/Desktop/Oracle/modelclustering.csv')
library(dplyr) #Load dplyr papckage for data cleaning
tbl_df(classification) 
head(classification) #inspect data structure

dim(classification) # inspect dimension of new dataset
summary(classification) #descriptive statistics of the dataset
apply(classification,2, function(x) sum(is.na(x))/length(x)*100) #NAs percentage detection
library(mice)
?mice

dim(classification)
m1<-mice(classification[,c(3,9)],m=1,method='pmm')
names(classification)[names(classification)=="AGE.AGE"] <- "AGE"
names(classification)[names(classification)=="AGE.INNET_MONTH"] <- "INNET_MONTH"
net1<-glmnet(as.matrix(class2[,2:24]),class2[,25],family='binomial',nlambda=10,alpha=1)
names(x1)

x1<-model.matrix(~SEX+CUST_TYPE+TERMINAL_TYPE+USER_LEVEL) #??????model.matrix??????????????????????????????????????????

class2$MAle=x1[,3]
class2$GOV_IND_CUS=x1[,5]
class2$GOV_3G=x1[,6]
class2$GOV_4G=x1[,7]
class2$GOLD=x1[,10]
class2$SILVER=x1[,12]
class2$NORMAL=x1[,9]   #????????????????????????????????????,????????????

class3<-class2[,-c(1,2,4,6,7,8)] #?????????????????????,????????????????????????
head(class3)
dim(class3)

library(glmnet) #??????glmnet???
net1<-glmnet(as.matrix(class3[,-19]),class3[,19],family='binomial',nlambda=100,alpha=1) #glmnet??????
net2<-cv.glmnet(as.matrix(class3[,-19]),as.factor(class3[,19]),family='binomial',nfold=10,type.measure='class',alpha=1) #??????????????????lasso??????????????????????????????????????????lambda
plot(net1)
plot(net2)
net2$lambda.min
net2$lambda.1se
coef(net2, s = "lambda.min") #???????????????????????????(????????????????????????)
